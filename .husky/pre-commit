#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Chạy lint-staged để kiểm tra các file đã staged
npx lint-staged

# Kiểm tra TypeScript compilation
echo "🔍 Checking TypeScript compilation..."
npm run build

# Kiểm tra Prisma schema nếu có thay đổi
if git diff --cached --name-only | grep -q "prisma/"; then
  echo "📋 Prisma changes detected, validating and formatting..."
  npx prisma validate
  npx prisma format
  git add prisma/schema.prisma
fi

echo "✅ Pre-commit checks passed!"
